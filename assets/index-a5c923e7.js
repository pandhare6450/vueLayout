import{L as E,M as S,N as P,O as L,P as k,i as I,m as _}from"./index-1732ad51.js";function C(e){return L()?(k(e),!0):!1}function A(e){return typeof e=="function"?e():I(e)}const w=typeof window<"u"&&typeof document<"u",M=Object.prototype.toString,W=e=>M.call(e)==="[object Object]",h=()=>{},D=N();function N(){var e;return w&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}function q(e,s={}){if(!E(e))return S(e);const o=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const n in e.value)o[n]=P(()=>({get(){return e.value[n]},set(a){var c;if((c=A(s.replaceRef))!=null?c:!0)if(Array.isArray(e.value)){const i=[...e.value];i[n]=a,e.value=i}else{const i={...e.value,[n]:a};Object.setPrototypeOf(i,Object.getPrototypeOf(e.value)),e.value=i}else e.value[n]=a}}));return o}function p(e){var s;const o=A(e);return(s=o==null?void 0:o.$el)!=null?s:o}const O=w?window:void 0;function v(...e){let s,o,n,a;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,n,a]=e,s=O):[s,o,n,a]=e,!s)return h;Array.isArray(o)||(o=[o]),Array.isArray(n)||(n=[n]);const c=[],f=()=>{c.forEach(l=>l()),c.length=0},i=(l,d,t,r)=>(l.addEventListener(d,t,r),()=>l.removeEventListener(d,t,r)),m=_(()=>[p(s),A(a)],([l,d])=>{if(f(),!l)return;const t=W(d)?{...d}:d;c.push(...o.flatMap(r=>n.map(u=>i(l,r,u,t))))},{immediate:!0,flush:"post"}),y=()=>{m(),f()};return C(y),y}let g=!1;function x(e,s,o={}){const{window:n=O,ignore:a=[],capture:c=!0,detectIframe:f=!1}=o;if(!n)return;D&&!g&&(g=!0,Array.from(n.document.body.children).forEach(t=>t.addEventListener("click",h)),n.document.documentElement.addEventListener("click",h));let i=!0;const m=t=>a.some(r=>{if(typeof r=="string")return Array.from(n.document.querySelectorAll(r)).some(u=>u===t.target||t.composedPath().includes(u));{const u=p(r);return u&&(t.target===u||t.composedPath().includes(u))}}),l=[v(n,"click",t=>{const r=p(e);if(!(!r||r===t.target||t.composedPath().includes(r))){if(t.detail===0&&(i=!m(t)),!i){i=!0;return}s(t)}},{passive:!0,capture:c}),v(n,"pointerdown",t=>{const r=p(e);r&&(i=!t.composedPath().includes(r)&&!m(t))},{passive:!0}),f&&v(n,"blur",t=>{setTimeout(()=>{var r;const u=p(e);((r=n.document.activeElement)==null?void 0:r.tagName)==="IFRAME"&&!(u!=null&&u.contains(n.document.activeElement))&&s(t)},0)})].filter(Boolean);return()=>l.forEach(t=>t())}export{x as o,q as t};
